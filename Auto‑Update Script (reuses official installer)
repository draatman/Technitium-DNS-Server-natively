#!/bin/bash
set -e

echo "ğŸ“¦ Updating Technitium DNS Server to the latest versionâ€¦"

# Stop service (if running)
sudo systemctl stop technitium-dns || true

# Backup current installation
BACKUP="/opt/technitium-dns-backup-$(date +%F_%H%M%S)"
echo "ğŸ“ Backing up current install to $BACKUP"
sudo cp -r /opt/technitium-dns "$BACKUP"

# Run official install script (this will overwrite binaries with latest)
curl -sSL https://download.technitium.com/dns/install.sh | sudo bash

echo "ğŸš€ Update complete!"
echo "ğŸ” Restarting serviceâ€¦"
sudo systemctl restart technitium-dns

echo "ğŸ‰ Done! Youâ€™re now running the latest version."
